test_that("model c fits are accurate", {
  pred <- method_c_predict(gagelmp = 250, birthwt = 2800)
  # filter(mc, gagelmp == 250, birthwt == 2800) %>% pull(fit)
  fit <- actual <- 269.2573
  expect_true(abs(pred - fit) < 0.002)

  pred <- method_c_predict(201:250, 2800)
  # fit <- filter(mc, gagelmp %in% 201:250, birthwt == 2800) %>% pull(fit)
  fit <- c(265.782, 265.901, 266.016, 266.126, 266.232, 266.333, 266.429,
    266.522, 266.612, 266.699, 266.784, 266.868, 266.952, 267.037,
    267.124, 267.213, 267.306, 267.402, 267.503, 267.609, 267.719,
    267.834, 267.954, 268.078, 268.205, 268.335, 268.466, 268.597,
    268.727, 268.854, 268.977, 269.094, 269.204, 269.304, 269.394,
    269.472, 269.538, 269.59, 269.627, 269.65, 269.659, 269.653,
    269.635, 269.603, 269.561, 269.51, 269.451, 269.388, 269.323,
    269.257)
  expect_true(sd(pred - fit) < 0.002)

  bwt <- seq(3005, 3500, by = 5)
  pred <- method_c_predict(250, bwt)
  # fit <- filter(mc, gagelmp == 250, birthwt %in% bwt) %>% pull(fit)
  fit <- c(272.389, 272.457, 272.524, 272.59, 272.656, 272.722, 272.787, 
    272.852, 272.916, 272.98, 273.035, 273.079, 273.123, 273.166, 
    273.208, 273.25, 273.292, 273.333, 273.374, 273.414, 273.454, 
    273.494, 273.533, 273.571, 273.609, 273.647, 273.684, 273.721, 
    273.757, 273.793, 273.829, 273.864, 273.898, 273.933, 273.966, 
    274, 274.033, 274.066, 274.098, 274.13, 274.161, 274.192, 274.223, 
    274.254, 274.284, 274.313, 274.343, 274.372, 274.4, 274.429, 
    274.457, 274.484, 274.512, 274.539, 274.566, 274.592, 274.618, 
    274.644, 274.67, 274.695, 274.721, 274.745, 274.77, 274.795, 
    274.819, 274.843, 274.867, 274.89, 274.914, 274.937, 274.96, 
    274.983, 275.005, 275.028, 275.05, 275.073, 275.095, 275.117, 
    275.139, 275.16, 275.182, 275.203, 275.225, 275.246, 275.268, 
    275.289, 275.31, 275.331, 275.352, 275.373, 275.395, 275.416, 
    275.437, 275.458, 275.479, 275.5, 275.521, 275.542, 275.563, 
    275.584)
  expect_true(sd(pred - fit) < 0.025)
})

test_that("model c doesn't accept garbage", {
  expect_error(method_c_predict(240:245, 3000:3002),
    regexp = "must be the same")

  expect_error(method_c_predict(150, 3000),
    "must be >= 161")

  expect_error(method_c_predict(400, 3000),
    "must be <= 350")

  expect_error(method_c_predict(200, 500),
    "must be >= 1000")

  expect_error(method_c_predict(200, 6000),
    "must be <= 5000")
})
